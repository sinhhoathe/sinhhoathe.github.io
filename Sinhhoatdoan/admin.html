<!DOCTYPE html><html lang="vi"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Qu·∫£n tr·ªã - Sinh ho·∫°t ƒëo√†n</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><link rel="stylesheet" href="css/style.css"><style>.sidebar{background:#fff;height:100vh;border-right:1px solid #eee;padding-top:1rem}.sidebar-item{padding:1rem;cursor:pointer;border-left:3px solid transparent}.sidebar-item:hover{background:#f9f9f9}.sidebar-item.is-active{border-left-color:var(--primary-color);background:#f0fdfa;font-weight:700;color:var(--primary-color)}.star-box{background:#fff3cd;color:#856404;padding:2px 8px;border-radius:12px;font-weight:700;display:inline-flex;align-items:center;gap:4px}</style></head><body><div id="loginSection" class="hero is-fullheight"><div class="hero-body"><div class="container" style="max-width:400px"><div class="card p-5 animate-fade-in"><div class="has-text-centered mb-4"><span class="icon is-large has-text-primary"><i class="fas fa-shield-alt fa-3x"></i></span><h1 class="title is-4 mt-3">ƒêƒÉng nh·∫≠p Qu·∫£n tr·ªã</h1></div><form id="loginForm"><div class="field"><label class="label">M·∫≠t kh·∫©u</label><div class="control has-icons-left"><input class="input" type="password" id="adminPass" placeholder="Nh·∫≠p m·∫≠t kh·∫©u qu·∫£n tr·ªã" required> <span class="icon is-small is-left"><i class="fas fa-lock"></i></span></div></div><button type="submit" class="button is-primary is-fullwidth mt-4">Truy c·∫≠p</button></form></div></div></div></div><div id="dashboardSection" class="is-hidden"><div class="columns is-gapless mb-0"><div class="column is-2 sidebar is-hidden-touch"><div class="has-text-centered mb-5 px-2"><h2 class="title is-5 has-text-primary">Admin Panel</h2><p class="is-size-7">ƒêo√†n ph∆∞·ªùng L√†o Cai</p></div><div class="sidebar-item is-active" onclick='switchTab("members")'><i class="fas fa-users mr-2"></i> Th√†nh vi√™n</div><div class="sidebar-item" onclick='switchTab("events")'><i class="fas fa-calendar-check mr-2"></i> Bu·ªïi Sinh ho·∫°t</div><div class="sidebar-item" onclick='switchTab("metadata")'><i class="fas fa-database mr-2"></i> D·ªØ li·ªáu ƒëƒÉng k√Ω</div><div class="sidebar-item has-text-danger mt-5" onclick="doLogout()"><i class="fas fa-sign-out-alt mr-2"></i> ƒêƒÉng xu·∫•t</div></div><div class="column is-10 has-background-light" style="min-height:100vh"><nav class="navbar is-white shadow-sm mb-4 px-4"><div class="navbar-brand"><div class="navbar-item is-hidden-desktop" onclick='document.querySelector(".sidebar").classList.toggle("is-hidden-touch")'><i class="fas fa-bars"></i></div><div class="navbar-item has-text-weight-bold" id="pageTitle">Qu·∫£n l√Ω Th√†nh vi√™n</div></div></nav><div class="p-4 container is-fluid"><div id="tabMembers"><div class="level"><div class="level-left"><div class="field has-addons"><p class="control"><input class="input" type="text" id="paramSearch" placeholder="T√¨m theo t√™n/SƒêT..."></p><p class="control"><button class="button is-info">T√¨m</button></p></div></div><div class="level-right"><button class="button is-success is-light" onclick="exportExcel()"><i class="fas fa-file-excel mr-2"></i> Xu·∫•t Excel</button></div></div><div class="card"><div class="card-content p-0"><div class="table-container"><table class="table is-fullwidth is-striped is-hoverable"><thead><tr><th>H·ªç v√† t√™n</th><th>NƒÉm sinh</th><th>Tr∆∞·ªùng/L·ªõp</th><th>SƒêT</th><th>Sao v√†ng</th><th>Tr·∫°ng th√°i</th><th>Thao t√°c</th></tr></thead><tbody id="memberList"></tbody></table></div></div></div></div><div id="tabEvents" class="is-hidden"><div class="level"><div class="level-left"><h2 class="subtitle">Danh s√°ch s·ª± ki·ªán</h2></div><div class="level-right"><button class="button is-primary" onclick="openCreateEventModal()"><i class="fas fa-plus mr-2"></i> T·∫°o bu·ªïi m·ªõi</button></div></div><div id="eventList" style="display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem"></div></div><div id="tabMetadata" class="is-hidden"><div class="level"><div class="level-left"><h2 class="subtitle">Qu·∫£n l√Ω D·ªØ li·ªáu ƒëƒÉng k√Ω</h2></div></div><div class="columns"><div class="column is-5"><div class="box h-100"><h3 class="title is-6">1. Danh s√°ch Tr∆∞·ªùng h·ªçc</h3><div class="field has-addons"><div class="control is-expanded"><input class="input" type="text" id="newSchoolInput" placeholder="Nh·∫≠p t√™n tr∆∞·ªùng..."></div><div class="control"><button class="button is-primary" onclick="addSchool()">Th√™m</button></div></div><p class="help mb-2 is-italic">Click v√†o t√™n tr∆∞·ªùng ƒë·ªÉ qu·∫£n l√Ω l·ªõp h·ªçc.</p><div id="schoolList" class="menu" style="max-height:400px;overflow-y:auto"></div></div></div><div class="column is-7"><div class="box h-100"><h3 class="title is-6" id="classTitle">2. Danh s√°ch L·ªõp h·ªçc</h3><div id="classControlArea" class="is-hidden"><div class="field has-addons"><div class="control is-expanded"><input class="input" type="text" id="newClassInput" placeholder="Nh·∫≠p t√™n l·ªõp (VD: 10A1)..."></div><div class="control"><button class="button is-success" onclick="addClass()">Th√™m l·ªõp</button></div></div><div id="classList" class="content mt-4" style="max-height:400px;overflow-y:auto"></div></div><div id="classEmptyMsg" class="has-text-centered has-text-grey p-5"><i class="fas fa-arrow-left mr-2"></i> Ch·ªçn m·ªôt tr∆∞·ªùng ƒë·ªÉ xem danh s√°ch l·ªõp.</div></div></div></div></div></div></div></div></div><div id="eventModal" class="modal"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title" id="modalTitle">T·∫°o bu·ªïi sinh ho·∫°t m·ªõi</p><button class="delete" aria-label="close" onclick='closeModal("eventModal")'></button></header><section class="modal-card-body"><form id="createEventForm"><div class="field"><label class="label">T√™n bu·ªïi sinh ho·∫°t</label><div class="control"><input class="input" type="text" id="evtName" placeholder="VD: Sinh ho·∫°t h√® T7/2026" required></div></div><div class="field"><label class="label">M√¥ t·∫£ bu·ªïi sinh ho·∫°t</label><div class="control"><textarea class="textarea" id="evtDesc" placeholder="Nh·∫≠p n·ªôi dung, ƒë·ªãa ch·ªâ ho·∫∑c l∆∞u √Ω cho bu·ªïi sinh ho·∫°t..." rows="2"></textarea></div></div><div class="columns"><div class="column is-6"><div class="field"><label class="label">Th·ªùi gian b·∫Øt ƒë·∫ßu</label><div class="control has-icons-left"><input class="input" type="datetime-local" id="evtStartTime" required> <span class="icon is-small is-left"><i class="fas fa-calendar-plus"></i></span></div><p class="help">ƒêo√†n vi√™n ch·ªâ c√≥ th·ªÉ ƒëi·ªÉm danh sau m·ªëc n√†y.</p></div></div><div class="column is-6"><div class="field"><label class="label">Th·ªùi gian k·∫øt th√∫c (T√πy ch·ªçn)</label><div class="control has-icons-left"><input class="input" type="datetime-local" id="evtEndTime"> <span class="icon is-small is-left"><i class="fas fa-clock"></i></span></div><p class="help">N·∫øu tr·ªëng, b·∫°n ph·∫£i ƒë√≥ng th·ªß c√¥ng.</p></div></div></div><div class="columns"><div class="column is-4"><div class="field"><label class="label">B√°n k√≠nh (m)</label><div class="control"><input class="input" type="number" id="evtRadius" value="100"></div></div></div><div class="column is-4"><div class="field"><label class="label">Vƒ© ƒë·ªô (Lat)</label><div class="control"><input class="input" type="number" step="any" id="evtLat" placeholder="VD: 21.123"></div></div></div><div class="column is-4"><div class="field"><label class="label">Kinh ƒë·ªô (Lng)</label><div class="control"><input class="input" type="number" step="any" id="evtLng" placeholder="VD: 105.123"></div></div></div></div><div class="field"><button type="button" class="button is-info is-small is-outlined" onclick="getAdminGPS()"><i class="fas fa-map-marker-alt mr-1"></i> L·∫•y t·ªça ƒë·ªô hi·ªán t·∫°i (GPS)</button><p class="help is-success is-hidden" id="gpsMsg"><span class="icon"><i class="fas fa-check"></i></span> ƒê√£ l·∫•y t·ªça ƒë·ªô! (Sai s·ªë: <span id="accVal"></span>m)</p><p class="help"><a id="mapLink" href="#" target="_blank" class="is-hidden"><i class="fas fa-map-marked-alt"></i> Xem v·ªã tr√≠ tr√™n Google Maps</a></p><article class="message is-warning is-small mt-2" id="gpsWarning"><div class="message-body"><strong>L∆∞u √Ω:</strong> GPS tr√™n m√°y t√≠nh th∆∞·ªùng b·ªã l·ªách 50-200m do d√πng ƒë·ªãnh v·ªã m·∫°ng.<br>N√™n d√πng <strong>ƒêi·ªán tho·∫°i</strong> ƒë·ªÉ l·∫•y t·ªça ƒë·ªô ch√≠nh x√°c nh·∫•t!</div></article></div></form></section><footer class="modal-card-foot"><button class="button is-success" onclick="saveEvent()">L∆∞u th√¥ng tin</button> <button class="button" onclick='closeModal("eventModal")'>H·ªßy</button></footer></div></div><script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script><script src="js/config.js"></script><script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script><script>let ADMIN_PASS="tranhuyhoang",CURRENT_GPS=null;function checkAuth(){"true"===sessionStorage.getItem("shd_admin")&&showDashboard()}function showDashboard(){document.getElementById("loginSection").classList.add("is-hidden"),document.getElementById("dashboardSection").classList.remove("is-hidden"),loadMembers(),loadEvents(),loadMetadata()}function doLogout(){sessionStorage.removeItem("shd_admin"),location.reload()}function switchTab(e){document.querySelectorAll(".sidebar-item").forEach(e=>e.classList.remove("is-active")),event.currentTarget.classList.add("is-active"),document.getElementById("tabMembers").classList.add("is-hidden"),document.getElementById("tabEvents").classList.add("is-hidden");var t=document.getElementById("tabMetadata");t&&t.classList.add("is-hidden"),"members"===e?(document.getElementById("tabMembers").classList.remove("is-hidden"),document.getElementById("pageTitle").textContent="Qu·∫£n l√Ω Th√†nh vi√™n"):"events"===e?(document.getElementById("tabEvents").classList.remove("is-hidden"),document.getElementById("pageTitle").textContent="Qu·∫£n l√Ω Bu·ªïi sinh ho·∫°t"):"metadata"===e&&(t&&t.classList.remove("is-hidden"),document.getElementById("pageTitle").textContent="Qu·∫£n l√Ω D·ªØ li·ªáu")}document.getElementById("loginForm").addEventListener("submit",e=>{e.preventDefault(),document.getElementById("adminPass").value===ADMIN_PASS?(sessionStorage.setItem("shd_admin","true"),showDashboard()):alert("M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!")});let adminMembers=[];function loadMembers(){db.ref("sinhhoatdoan/members").on("value",e=>{e=e.val();e?(adminMembers=Object.entries(e).map(([e,t])=>({...t,key:e}))).sort((e,t)=>(t.stars||0)-(e.stars||0)):adminMembers=[],renderAdminMembers(adminMembers)})}function renderAdminMembers(e){let a=document.getElementById("memberList");a.innerHTML="",0===e.length?a.innerHTML='<tr><td colspan="8" class="has-text-centered">Ch∆∞a c√≥ th√†nh vi√™n n√†o</td></tr>':e.forEach(e=>{let t="";e.school&&(t+=e.school),e.className&&(t+=t?" - "+e.className:e.className);var n=document.createElement("tr");n.innerHTML=`
                    <td><strong>${e.fullName}</strong></td>
                    <td>${e.birthYear}</td>
                    <td>${t}</td>
                    <td>${e.phone}</td>
                    <td><div class="star-box"><i class="fas fa-star"></i> ${e.stars||0}</div></td>
                    <td><span class="tag ${"active"===e.status?"is-success":"is-dark"} is-light">${e.status}</span></td>
                    <td>
                        <div class="buttons are-small">
                            <button class="button is-danger is-light" onclick="deleteMember('${e.key}')">X√≥a</button>
                            <button class="button is-warning is-light" onclick="adjustStar('${e.key}', ${e.stars||0})">+ Sao</button>
                        </div>
                    </td>
                `,a.appendChild(n)})}function deleteMember(e){confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a th√†nh vi√™n n√†y?")&&db.ref("sinhhoatdoan/members/"+e).remove()}function adjustStar(e,t){t=prompt("Nh·∫≠p s·ªë sao m·ªõi:",t+1);null!==t&&db.ref("sinhhoatdoan/members/"+e).update({stars:parseInt(t)})}document.getElementById("paramSearch").addEventListener("input",e=>{let t=e.target.value.toLowerCase().trim();t?renderAdminMembers(adminMembers.filter(e=>e.fullName&&e.fullName.toLowerCase().includes(t)||e.phone&&e.phone.includes(t))):renderAdminMembers(adminMembers)});let editingEventKey=null;function loadEvents(){db.ref("sinhhoatdoan/events").on("value",e=>{let d=document.getElementById("eventList");d.innerHTML="";e=e.val();e&&Object.entries(e).sort((e,t)=>t[1].startTime-e[1].startTime).forEach(([e,t])=>{var n=document.createElement("div"),a=(n.className="animate-fade-in",Date.now());let s=!1,i=!1,l=(t.endTime&&a>t.endTime&&(s=!0),t.startTime&&a<t.startTime&&(i=!0),"is-danger"),o="ƒê√£ ƒë√≥ng";t.isOpen&&(o=s?"H·∫øt h·∫°n":i?(l="is-warning","Ch·ªù b·∫Øt ƒë·∫ßu"):(l="is-success","ƒêang m·ªü")),n.innerHTML=`
                         <div class="card h-100">
                             <header class="card-header has-background-light">
                                 <p class="card-header-title">${t.name}</p>
                             </header>
                             <div class="card-content">
                                 <div class="tags are-medium mb-2">
                                     <span class="tag ${l}">${o}</span>
                                     <span class="tag is-info is-light"><i class="fas fa-calendar-alt mr-1"></i> ${new Date(t.startTime).toLocaleDateString("vi-VN")}</span>
                                 </div>
                                 <div class="is-size-7 mb-1">
                                    <i class="fas fa-play-circle has-text-success mr-1"></i> B·∫Øt ƒë·∫ßu: ${new Date(t.startTime).toLocaleString("vi-VN")}
                                 </div>
                                 ${t.endTime?`
                                    <div class="is-size-7 mb-2">
                                        <i class="fas fa-stop-circle has-text-danger mr-1"></i> K·∫øt th√∫c: ${new Date(t.endTime).toLocaleString("vi-VN")}
                                    </div>
                                 `:""}
                                <div class="content is-size-7 mt-3">
                                    <div class="mb-2">
                                        <strong>M√¥ t·∫£:</strong> 
                                        <div class="description-wrapper mt-1">
                                            <span class="desc-content preserve-newline" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; line-height: 1.5;">${t.description||"Kh√¥ng c√≥ m√¥ t·∫£"}</span>
                                            ${t.description&&80<t.description.length?`
                                                <a href="javascript:void(0)" class="has-text-link" onclick="const s = this.previousElementSibling.style; if(s.display === '-webkit-box') { s.display = 'block'; this.innerText = 'Thu g·ªçn'; } else { s.display = '-webkit-box'; this.innerText = 'Xem th√™m'; }">Xem th√™m</a>
                                            `:""}
                                        </div>
                                    </div>
                                    <p><i class="fas fa-map-marker-alt"></i> BK: ${t.radius}m</p>
                                    <p>
                                        <a href="https://www.google.com/maps?q=${t.location?.lat},${t.location?.lng}" target="_blank" class="has-text-link">
                                            <i class="fas fa-directions"></i> Xem v·ªã tr√≠ tr√™n Google Maps
                                        </a>
                                    </p>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item has-text-primary" onclick="toggleEvent('${e}', ${!t.isOpen})">
                                    ${t.isOpen?"üîí ƒê√≥ng":"üîì M·ªü"}
                                </a>
                                <a href="#" class="card-footer-item has-text-info" onclick='openEditEventModal("${e}", ${JSON.stringify(t)})'>
                                    ‚úèÔ∏è S·ª≠a
                                </a>
                                <a href="#" class="card-footer-item has-text-danger" onclick="deleteEvent('${e}')">X√≥a</a>
                            </footer>
                        </div>
                    `,d.appendChild(n)})})}function openCreateEventModal(){editingEventKey=null,document.getElementById("modalTitle").textContent="T·∫°o bu·ªïi sinh ho·∫°t m·ªõi",document.getElementById("createEventForm").reset();var e=new Date,t=6e4*e.getTimezoneOffset(),e=new Date(e.getTime()-t).toISOString().slice(0,16);document.getElementById("evtStartTime").value=e,document.getElementById("eventModal").classList.add("is-active"),document.getElementById("gpsMsg").classList.add("is-hidden"),CURRENT_GPS=null}function openEditEventModal(e,t){var n;editingEventKey=e,document.getElementById("modalTitle").textContent="C·∫≠p nh·∫≠t bu·ªïi sinh ho·∫°t",document.getElementById("evtName").value=t.name,document.getElementById("evtDesc").value=t.description||"",document.getElementById("evtRadius").value=t.radius,t.startTime&&(n=6e4*(e=new Date(t.startTime)).getTimezoneOffset(),e=new Date(e.getTime()-n).toISOString().slice(0,16),document.getElementById("evtStartTime").value=e),t.endTime?(e=6e4*(n=new Date(t.endTime)).getTimezoneOffset(),n=new Date(n.getTime()-e).toISOString().slice(0,16),document.getElementById("evtEndTime").value=n):document.getElementById("evtEndTime").value="",t.location&&(CURRENT_GPS=t.location,document.getElementById("evtLat").value=t.location.lat,document.getElementById("evtLng").value=t.location.lng,e=`https://www.google.com/maps?q=${t.location.lat},`+t.location.lng,(n=document.getElementById("mapLink")).href=e,n.innerHTML='<i class="fas fa-map-marked-alt"></i> Xem v·ªã tr√≠ n√†y tr√™n Google Maps',n.classList.remove("is-hidden")),document.getElementById("eventModal").classList.add("is-active")}function closeModal(e){document.getElementById(e).classList.remove("is-active")}function getAdminGPS(){if(!navigator.geolocation)return alert("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ GPS");let n=event.currentTarget;n.classList.add("is-loading"),navigator.geolocation.getCurrentPosition(e=>{CURRENT_GPS={lat:e.coords.latitude,lng:e.coords.longitude};var e=Math.round(e.coords.accuracy),t=(document.getElementById("evtLat").value=CURRENT_GPS.lat,document.getElementById("evtLng").value=CURRENT_GPS.lng,document.getElementById("gpsMsg").classList.remove("is-hidden"),document.getElementById("accVal").textContent=e,n.classList.remove("is-loading"),document.getElementById("gpsMsg")),t=(t.className=e<50?"help is-success":e<200?"help is-warning":"help is-danger",`https://www.google.com/maps?q=${CURRENT_GPS.lat},`+CURRENT_GPS.lng),e=document.getElementById("mapLink");e.href=t,e.classList.remove("is-hidden")},e=>{n.classList.remove("is-loading"),alert("L·ªói l·∫•y GPS: "+e.message+"\n\nL∆∞u √Ω: B·∫°n ph·∫£i cho ph√©p quy·ªÅn v·ªã tr√≠ tr√™n tr√¨nh duy·ªát v√† n√™n d√πng ƒëi·ªán tho·∫°i.")},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})}function saveEvent(){var e=document.getElementById("evtName").value,t=document.getElementById("evtDesc").value,n=document.getElementById("evtRadius").value,a=document.getElementById("evtStartTime").value,s=document.getElementById("evtEndTime").value,i=parseFloat(document.getElementById("evtLat").value),l=parseFloat(document.getElementById("evtLng").value);return e?a?i&&l?(e={name:e,description:t,radius:parseInt(n),location:{lat:i,lng:l},startTime:new Date(a).getTime(),endTime:s?new Date(s).getTime():null},editingEventKey?db.ref("sinhhoatdoan/events/"+editingEventKey).update(e):db.ref("sinhhoatdoan/events").push({...e,isOpen:!0}),void closeModal("eventModal")):alert("Vui l√≤ng l·∫•y t·ªça ƒë·ªô ho·∫∑c nh·∫≠p t·ªça ƒë·ªô!"):alert("Vui l√≤ng ch·ªçn th·ªùi gian b·∫Øt ƒë·∫ßu"):alert("Vui l√≤ng nh·∫≠p t√™n")}function toggleEvent(e,t){db.ref("sinhhoatdoan/events/"+e).update({isOpen:t})}function deleteEvent(e){confirm("X√≥a s·ª± ki·ªán n√†y?")&&db.ref("sinhhoatdoan/events/"+e).remove()}function exportExcel(){var e=document.querySelector("table"),e=XLSX.utils.table_to_book(e);XLSX.writeFile(e,"DanhSach_SinhHoatDoan.xlsx")}let currentSchoolId=null;function loadMetadata(){db.ref("sinhhoatdoan/metadata/schools").on("value",e=>{renderSchoolList(e.val()||{})})}function renderSchoolList(e){var t=document.getElementById("schoolList");if(t.innerHTML="",e){let s=document.createElement("ul");s.className="menu-list",Object.entries(e).forEach(([e,t])=>{var n=document.createElement("li"),a=document.createElement("a");a.className="is-flex is-justify-content-space-between is-align-items-center",a.innerHTML=`
                    <span onclick="selectSchool('${e}', '${t.replace(/'/g,"\\'")}')" class="is-flex-grow-1">${t}</span>
                    <button class="button is-small is-danger is-light ml-2" onclick="deleteSchool('${e}')">
                        <i class="fas fa-trash"></i>
                    </button>
                `,currentSchoolId===e&&a.classList.add("is-active"),n.appendChild(a),s.appendChild(n)}),t.appendChild(s)}else t.innerHTML='<p class="has-text-grey is-italic p-2">Ch∆∞a c√≥ tr∆∞·ªùng n√†o.</p>'}function addSchool(){var e=document.getElementById("newSchoolInput"),t=e.value.trim();t&&(db.ref("sinhhoatdoan/metadata/schools").push(t),e.value="")}function deleteSchool(e){confirm("X√≥a tr∆∞·ªùng n√†y s·∫Ω x√≥a T·∫§T C·∫¢ l·ªõp h·ªçc thu·ªôc tr∆∞·ªùng. Ti·∫øp t·ª•c?")&&(db.ref("sinhhoatdoan/metadata/schools/"+e).remove(),db.ref("sinhhoatdoan/metadata/classes/"+e).remove(),currentSchoolId===e)&&(currentSchoolId=null,resetClassView())}function selectSchool(e,t){currentSchoolId=e,document.querySelectorAll("#schoolList a").forEach(e=>e.classList.remove("is-active")),document.getElementById("classTitle").textContent="2. L·ªõp h·ªçc - "+t,document.getElementById("classControlArea").classList.remove("is-hidden"),document.getElementById("classEmptyMsg").classList.add("is-hidden"),loadClasses(e)}function loadClasses(t){db.ref("sinhhoatdoan/metadata/classes/"+t).on("value",e=>{renderClassList(e.val()||{},t)})}function renderClassList(e,s){var t=document.getElementById("classList");if(t.innerHTML="",currentSchoolId===s)if(e){let a=document.createElement("ul");Object.entries(e).forEach(([e,t])=>{var n=document.createElement("li");n.className="is-flex is-justify-content-space-between is-align-items-center mb-2 p-2 has-background-white-ter",n.style.borderRadius="4px",n.innerHTML=`
                    <span>${t}</span>
                    <button class="button is-small is-danger is-light" onclick="deleteClass('${s}', '${e}')">
                        <i class="fas fa-trash"></i>
                    </button>
                `,a.appendChild(n)}),t.appendChild(a)}else t.innerHTML='<p class="has-text-grey is-italic">Ch∆∞a c√≥ l·ªõp n√†o.</p>'}function addClass(){if(!currentSchoolId)return alert("Ch·ªçn tr∆∞·ªùng tr∆∞·ªõc!");var e=document.getElementById("newClassInput"),t=e.value.trim();t&&(db.ref("sinhhoatdoan/metadata/classes/"+currentSchoolId).push(t),e.value="")}function deleteClass(e,t){confirm("X√≥a l·ªõp n√†y?")&&db.ref(`sinhhoatdoan/metadata/classes/${e}/`+t).remove()}function resetClassView(){document.getElementById("classTitle").textContent="2. Danh s√°ch L·ªõp h·ªçc",document.getElementById("classControlArea").classList.add("is-hidden"),document.getElementById("classEmptyMsg").classList.remove("is-hidden"),document.getElementById("classList").innerHTML=""}checkAuth()</script></body></html>