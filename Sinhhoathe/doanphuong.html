<!DOCTYPE html><html lang="vi"><head><meta charset="utf-8"><meta name="robots" content="noindex, nofollow"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ÄoÃ n phÆ°á»ng - Danh sÃ¡ch Ä‘Äƒng kÃ½</title><link rel="stylesheet" href="/Sinhhoathe/main.css"><style>body{background:#f7f8fc}.container{max-width:1100px}.card{border-radius:14px;box-shadow:0 12px 30px rgba(0,0,0,.06)}.table td,.table th{vertical-align:middle}.compact-table.table td,.compact-table.table th{padding:6px 8px}.compact-table{font-size:.9rem}</style><link rel="icon" href="/assets/images/ballbang_favicon.png"></head><body><section id="adminGate" class="section" style="display:none"><div class="container" style="max-width:420px"><div class="card"><div class="card-content"><h2 class="title is-5">ÄoÃ n phÆ°á»ng - ÄÄƒng nháº­p</h2><div class="field"><label class="label">ID</label><div class="control"><input id="gateId" class="input" placeholder="Nháº­p ID:..."></div></div><div class="field"><label class="label">Máº­t kháº©u</label><div class="control"><input id="gatePass" class="input" type="password" placeholder="Nháº­p máº­t kháº©u"></div></div><div class="field is-grouped"><div class="control"><button id="btnGateLogin" class="button is-primary">ÄÄƒng nháº­p</button></div></div><p id="gateErr" class="help is-danger" style="display:none">Sai ID hoáº·c máº­t kháº©u.</p></div></div></div></section><section id="adminApp" class="section" style="display:none"><div class="container"><div class="level"><div class="level-left"><div><h1 class="title is-3">ÄoÃ n phÆ°á»ng</h1><p class="subtitle is-6">Quáº£n lÃ½ toÃ n bá»™ há»‡ thá»‘ng Ä‘Äƒng kÃ½ sinh hoáº¡t hÃ¨.</p></div></div><div class="level-right"><button id="btnLogoutAdmin" class="button is-light">ÄÄƒng xuáº¥t</button></div></div><div class="tabs is-boxed is-medium"><ul><li class="is-active" data-tab="registrations"><a><span>ğŸ“‹ Danh sÃ¡ch Ä‘Äƒng kÃ½</span></a></li><li data-tab="categories"><a><span>ğŸ« Quáº£n lÃ½ danh má»¥c</span></a></li><li data-tab="passwords"><a><span>ğŸ”‘ Thiáº¿t láº­p máº­t kháº©u</span></a></li></ul></div><div id="tabRegistrations" class="tab-content"><div class="card"><div class="card-content"><div class="level"><div class="level-left"><h2 class="title is-5">Danh sÃ¡ch Ä‘Äƒng kÃ½ <span id="countBadge" class="tag is-info is-light" style="margin-left:8px">0/0</span></h2></div><div class="level-right"><div class="field has-addons"><p class="control"><span class="select"><select id="filterField"><option value="school">TrÆ°á»ng há»c</option><option value="hamlet">ThÃ´n/Tá»•</option></select></span></p><p class="control"><input id="filterValue" class="input" placeholder="Lá»c theo trÆ°á»ng há»c"></p><p class="control"><button id="btnReload" class="button is-light">Táº£i láº¡i</button></p></div></div></div><div class="table-container"><table class="table is-fullwidth is-striped is-hoverable is-narrow compact-table"><thead><tr><th>#</th><th>TrÆ°á»ng</th><th>Há» vÃ  tÃªn</th><th>NÄƒm sinh</th><th>Äá»‹a chá»‰</th><th>Phá»¥ huynh</th><th>Äiá»‡n thoáº¡i PH</th><th>Xáº¿p loáº¡i</th></tr></thead><tbody id="tblBody"></tbody></table></div></div></div></div><div id="tabCategories" class="tab-content" style="display:none"><div class="card"><div class="card-content"><h2 class="title is-5">Quáº£n lÃ½ danh má»¥c (ADMIN)</h2><p class="subtitle is-6">ThÃªm/xÃ³a trÆ°á»ng há»c, xÃ£/phÆ°á»ng, vÃ  thÃ´n/tá»• dÃ¢n phá»‘.</p><div class="columns"><div class="column is-4"><div class="box"><h3 class="title is-6">TrÆ°á»ng há»c</h3><div class="field has-addons"><p class="control is-expanded"><input id="inpSchool" class="input" placeholder="Nháº­p tÃªn trÆ°á»ng"></p><p class="control"><button id="btnAddSchool" class="button is-primary">ThÃªm</button></p></div><div id="listSchools" class="content" style="max-height:200px;overflow:auto"></div></div></div><div class="column is-4"><div class="box"><h3 class="title is-6">XÃ£/PhÆ°á»ng</h3><div class="field has-addons"><p class="control is-expanded"><input id="inpWard" class="input" placeholder="Nháº­p tÃªn xÃ£/phÆ°á»ng"></p><p class="control"><button id="btnAddWard" class="button is-primary">ThÃªm</button></p></div><div id="listWards" class="content" style="max-height:200px;overflow:auto"></div></div></div><div class="column is-4"><div class="box"><h3 class="title is-6">ThÃ´n/Tá»• dÃ¢n phá»‘</h3><div class="field"><div class="select is-fullwidth"><select id="selWardForHamlet"></select></div></div><div class="field has-addons" style="margin-top:6px"><p class="control is-expanded"><input id="inpHamlet" class="input" placeholder="Nháº­p tÃªn thÃ´n/tá»•"></p><p class="control"><button id="btnAddHamlet" class="button is-primary">ThÃªm</button></p></div><div id="listHamlets" class="content" style="max-height:200px;overflow:auto"></div></div></div></div><div class="field"><button id="btnSaveMeta" class="button is-link is-fullwidth">ğŸ’¾ LÆ°u táº¥t cáº£ danh má»¥c</button></div></div></div></div><div id="tabPasswords" class="tab-content" style="display:none"><div class="card"><div class="card-content"><h2 class="title is-5">Thiáº¿t láº­p máº­t kháº©u thÃ´n/tá»•</h2><p class="subtitle is-6">Táº¡o ID vÃ  máº­t kháº©u cho tá»«ng tá»• trÆ°á»Ÿng/trÆ°á»Ÿng thÃ´n Ä‘á»ƒ há» cÃ³ thá»ƒ Ä‘Äƒng nháº­p vÃ o há»‡ thá»‘ng.</p><div id="pwList"></div><div class="field" style="margin-top:12px"><button id="btnSaveAllPw" class="button is-primary is-fullwidth">ğŸ” LÆ°u táº¥t cáº£ máº­t kháº©u</button></div></div></div></div></div></section><script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script><script src="/Sinhhoathe/firebase.config.js"></script><script>let tblBody=document.getElementById("tblBody"),filterField=document.getElementById("filterField"),filterValue=document.getElementById("filterValue"),countBadge=document.getElementById("countBadge"),inpSchool=document.getElementById("inpSchool"),btnAddSchool=document.getElementById("btnAddSchool"),listSchools=document.getElementById("listSchools"),inpWard=document.getElementById("inpWard"),btnAddWard=document.getElementById("btnAddWard"),listWards=document.getElementById("listWards"),selWardForHamlet=document.getElementById("selWardForHamlet"),inpHamlet=document.getElementById("inpHamlet"),btnAddHamlet=document.getElementById("btnAddHamlet"),listHamlets=document.getElementById("listHamlets"),btnSaveMeta=document.getElementById("btnSaveMeta"),pwList=document.getElementById("pwList"),btnSaveAllPw=document.getElementById("btnSaveAllPw"),REG_CACHE=[],DEFAULT_META={schools:["A","B","C"],wards:["xa-1","xa-2","phuong-1","phuong-2"],hamlets:{"xa-1":["ThÃ´n A","ThÃ´n B","ThÃ´n C"],"xa-2":["ThÃ´n D","ThÃ´n E"],"phuong-1":["Tá»• 1","Tá»• 2","Tá»• 3"],"phuong-2":["Tá»• 4","Tá»• 5"]}},META=DEFAULT_META,PASSWORDS={};function subscribeRegistrations(){var e;window.firebase&&window.firebase.apps&&window.firebase.apps.length&&((e=firebase.database().ref("Sinhhoathe/Registrations")).off(),e.on("value",e=>{let a=e.val(),l=[];a&&"object"==typeof a&&Object.keys(a).forEach(e=>{var t=a[e]||{};l.push({_key:e,...t})}),l.sort((e,t)=>(e.school||"").localeCompare(t.school||"")||(e.fullName||"").localeCompare(t.fullName||"")),REG_CACHE=l,renderTable()}))}function renderTable(){let a=filterField&&filterField.value||"school",l=(filterValue&&filterValue.value||"").trim().toLowerCase();var e=REG_CACHE.slice();tblBody.innerHTML="";let n=1;var t=e.length;let s=0;t?(e.forEach(e=>{if(l)if("hamlet"===a){if(-1===(e.hamlet||"").toLowerCase().indexOf(l))return}else if(-1===(e.school||"").toLowerCase().indexOf(l))return;s++;var t=document.createElement("tr");t.innerHTML=`
            <td>${n++}</td>
            <td>${e.school||""}</td>
            <td>${e.fullName||""}</td>
            <td>${e.birthYear||""}</td>
            <td>
              <strong>${e.hamlet||""}</strong><br>
              <span class="is-size-7 has-text-grey">${e.ward||""}</span>
            </td>
            <td>${e.parentName||""}</td>
            <td>${e.parentPhone||""}</td>
            <td>${e.grade||""}</td>
            <td>
              <button class="button is-danger is-small btn-delete" data-key="${e._key}">
                XoÃ¡
              </button>
            </td>
          `,tblBody.appendChild(t)}),tblBody.querySelectorAll(".btn-delete").forEach(e=>{e.addEventListener("click",e=>{var t,e=e.target.getAttribute("data-key");e&&("tranhuyhoang"===(t=prompt("Nháº­p máº­t kháº©u ADMIN Ä‘á»ƒ xÃ³a:"))?confirm("Cháº¯c cháº¯n xÃ³a?")&&firebase.database().ref("Sinhhoathe/Registrations").child(e).remove().then(()=>alert("ÄÃ£ xÃ³a!")).catch(e=>alert("Lá»—i!")):null!==t&&alert("Sai máº­t kháº©u"))})}),countBadge&&(countBadge.textContent=s+"/"+t)):(e=document.createElement("tr"),(t=document.createElement("td")).colSpan=9,t.className="has-text-centered has-text-grey",t.textContent="ChÆ°a cÃ³ dá»¯ liá»‡u.",e.appendChild(t),tblBody.appendChild(e),countBadge&&(countBadge.textContent="0/0"))}function subscribeMeta(){var e;window.firebase&&window.firebase.apps&&window.firebase.apps.length&&((e=firebase.database().ref("Sinhhoathe/Meta")).off(),e.on("value",e=>{META=e.val()||DEFAULT_META,renderMeta(),renderPwList()}))}function saveMetaToFirebase(){return window.firebase&&window.firebase.apps&&window.firebase.apps.length?firebase.database().ref("Sinhhoathe/Meta").set(META):Promise.resolve()}function renderMeta(){listSchools.innerHTML="",(META.schools||[]).forEach((e,t)=>{var a=document.createElement("p");a.innerHTML=e+` <button class="button is-small is-light" data-del-school="${t}">XÃ³a</button>`,listSchools.appendChild(a)}),listWards.innerHTML="";var e=selWardForHamlet.value,e=(selWardForHamlet.innerHTML="",(META.wards||[]).forEach((e,t)=>{var a=document.createElement("p"),t=(a.innerHTML=e+` <button class="button is-small is-light" data-del-ward="${t}">XÃ³a</button>`,listWards.appendChild(a),document.createElement("option"));t.value=e,t.textContent=e,selWardForHamlet.appendChild(t)}),(META.wards||[]).includes(e)?selWardForHamlet.value=e:(META.wards||[]).length&&(selWardForHamlet.value=META.wards[0]),listHamlets.innerHTML="",selWardForHamlet.value);(META.hamlets&&META.hamlets[e]?META.hamlets[e]:[]).forEach((e,t)=>{var a=document.createElement("p");a.innerHTML=e+` <button class="button is-small is-light" data-del-hamlet="${t}">XÃ³a</button>`,listHamlets.appendChild(a)})}function subscribePasswords(){var e;window.firebase&&window.firebase.apps&&window.firebase.apps.length&&((e=firebase.database().ref("Sinhhoathe/Passwords")).off(),e.on("value",e=>{PASSWORDS=e.val()||{},renderPwList()}))}function savePasswordsToFirebase(e){return window.firebase&&window.firebase.apps&&window.firebase.apps.length?firebase.database().ref("Sinhhoathe/Passwords").set(e):Promise.resolve()}function renderPwList(){pwList.innerHTML="",(META.wards||[]).forEach(n=>{var e=document.createElement("details"),t=(e.className="box",e.style.marginBottom="1rem",document.createElement("summary"));t.className="title is-6 has-text-link",t.style.cursor="pointer",t.style.outline="none",t.textContent=`ğŸ“‚ ${n.toUpperCase()} (Nháº¥n Ä‘á»ƒ hiá»‡n danh sÃ¡ch)`,e.appendChild(t);let s=document.createElement("div");s.style.marginTop="1rem",(META.hamlets&&META.hamlets[n]?META.hamlets[n]:[]).forEach(e=>{var t=n+"__"+e,a=document.createElement("div"),l=(a.className="field is-horizontal",PASSWORDS[t]||PASSWORDS[e]||{});a.innerHTML=`
              <div class="field-label is-normal" style="flex-grow: 2; text-align: left; min-width: 150px;">
                <label class="label">${e}</label>
              </div>
              <div class="field-body">
                <div class="field has-addons">
                  <p class="control is-expanded">
                    <input class="input" type="text" 
                      data-comp-key="${t}" 
                      data-ward="${n}"
                      data-hamlet="${e}"
                      data-type="id"
                      placeholder="ID ÄÄƒng nháº­p" value="${l.id||""}">
                  </p>
                  <p class="control is-expanded">
                    <input class="input" type="text" 
                      data-comp-key="${t}" 
                      data-type="pass"
                      placeholder="Máº­t kháº©u" value="${l.password||l||""}">
                  </p>
                </div>
              </div>`,s.appendChild(a)}),e.appendChild(s),pwList.appendChild(e)})}function bootAdmin(){subscribeRegistrations(),subscribeMeta(),subscribePasswords(),renderTable()}function initTabs(){let a=document.querySelectorAll(".tabs li"),l=document.querySelectorAll(".tab-content");a.forEach(t=>{t.addEventListener("click",()=>{var e=t.getAttribute("data-tab"),e=(a.forEach(e=>e.classList.remove("is-active")),t.classList.add("is-active"),l.forEach(e=>{e.style.display="none"}),document.getElementById("tab"+e.charAt(0).toUpperCase()+e.slice(1)));e&&(e.style.display="")})})}document.getElementById("btnReload").addEventListener("click",renderTable),filterField&&filterField.addEventListener("change",()=>{"hamlet"===filterField.value?filterValue.placeholder="Lá»c theo thÃ´n/tá»•":filterValue.placeholder="Lá»c theo trÆ°á»ng há»c",renderTable()}),filterValue&&filterValue.addEventListener("input",renderTable),btnAddSchool.addEventListener("click",()=>{let t=(inpSchool.value||"").trim();t&&(META.schools=META.schools||[],META.schools.some(e=>(e||"").trim().toLowerCase()===t.toLowerCase())||META.schools.push(t),inpSchool.value="",renderMeta())}),btnAddWard.addEventListener("click",()=>{let t=(inpWard.value||"").trim();t&&(META.wards=META.wards||[],META.wards.some(e=>(e||"").trim().toLowerCase()===t.toLowerCase())||META.wards.push(t),META.hamlets=META.hamlets||{},META.hamlets[t]=META.hamlets[t]||[],inpWard.value="",renderMeta(),selWardForHamlet.value=t,renderMeta())}),selWardForHamlet.addEventListener("change",renderMeta),btnAddHamlet.addEventListener("click",()=>{var e=selWardForHamlet.value;let t=(inpHamlet.value||"").trim();e&&t&&(META.hamlets=META.hamlets||{},META.hamlets[e]=META.hamlets[e]||[],META.hamlets[e].some(e=>(e||"").trim().toLowerCase()===t.toLowerCase())||META.hamlets[e].push(t),inpHamlet.value="",renderMeta())}),listSchools.addEventListener("click",e=>{e=e.target.getAttribute("data-del-school");null!==e&&(META.schools.splice(parseInt(e,10),1),saveMetaToFirebase())}),listWards.addEventListener("click",e=>{var e=e.target.getAttribute("data-del-ward");null!==e&&(e=META.wards.splice(parseInt(e,10),1)[0],META.hamlets&&delete META.hamlets[e],saveMetaToFirebase(),renderMeta(),renderPwList())}),listHamlets.addEventListener("click",e=>{var t,e=e.target.getAttribute("data-del-hamlet");null!==e&&(t=selWardForHamlet.value,META.hamlets[t].splice(parseInt(e,10),1),saveMetaToFirebase(),renderMeta(),renderPwList())}),btnSaveMeta.addEventListener("click",()=>{saveMetaToFirebase().then(()=>alert("ÄÃ£ lÆ°u danh má»¥c."))}),btnSaveAllPw.addEventListener("click",()=>{let s=JSON.parse(JSON.stringify(PASSWORDS||{}));pwList.querySelectorAll("input[data-comp-key]").forEach(e=>{var t=e.getAttribute("data-comp-key"),a=e.getAttribute("data-type"),l=e.getAttribute("data-ward"),n=e.getAttribute("data-hamlet");s[t]||(s[t]={}),l&&n&&(s[t].wardName=l,s[t].hamletName=n),"id"===a&&(s[t].id=(e.value||"").trim()),"pass"===a&&(s[t].password=(e.value||"").trim())}),savePasswordsToFirebase(s).then(()=>{alert("ÄÃ£ lÆ°u táº¥t cáº£ máº­t kháº©u! (ÄÃ£ xá»­ lÃ½ trÃ¹ng tÃªn tá»•)")}).catch(()=>alert("KhÃ´ng thá»ƒ lÆ°u máº­t kháº©u."))});let btnLogoutAdmin=document.getElementById("btnLogoutAdmin");btnLogoutAdmin&&btnLogoutAdmin.addEventListener("click",()=>{sessionStorage.removeItem("dp-admin-auth"),location.reload()}),(()=>{let s=document.getElementById("adminGate"),d=document.getElementById("adminApp");if("ok"===sessionStorage.getItem("dp-admin-auth"))s.style.display="none",d.style.display="",bootAdmin(),initTabs();else{s.style.display="",d.style.display="none";var e=document.getElementById("btnGateLogin");let a=document.getElementById("gateId"),l=document.getElementById("gatePass"),n=document.getElementById("gateErr");e.addEventListener("click",()=>{var e=(a.value||"").trim(),t=(l.value||"").trim();"ADMIN"===e&&"tranhuyhoang"===t?(sessionStorage.setItem("dp-admin-auth","ok"),s.style.display="none",d.style.display="",bootAdmin(),initTabs()):n.style.display=""})}})()</script></body></html>