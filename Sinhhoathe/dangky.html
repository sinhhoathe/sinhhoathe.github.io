<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ƒêƒÉng k√Ω sinh ho·∫°t h√®</title>
    <link rel="stylesheet" href="/Sinhhoathe/main.css" />
    <style>
      body {
        background: #f7f8fc;
      }
      .is-required::after {
        content: " *";
        color: #ff3860;
      }
      .help.is-error {
        color: #ff3860;
      }
    </style>
    <link rel="icon" href="/assets/images/ballbang_favicon.png" />
    <meta name="robots" content="noindex, nofollow" />
  </head>

  <body>
    <section class="section">
      <div class="container" style="max-width: 800px">
        <h1 class="title is-3 has-text-centered">
          üìù Phi·∫øu ƒëƒÉng k√Ω sinh ho·∫°t h√® Online
        </h1>
        <p class="subtitle is-6 has-text-centered">
          Gi√†nh cho ƒê·ªôi vi√™n, thi·∫øu nhi tham gia sinh ho·∫°t t·∫°i ƒë·ªãa ph∆∞∆°ng h√® nƒÉm 2026
        </p>

        <div class="card">
          <div class="card-content">
            <form id="summerForm" novalidate>
              <div class="field">
                <label class="label is-required">H·ªç v√† t√™n h·ªçc sinh</label>
                <div class="control">
                  <input
                    id="fullName"
                    class="input"
                    type="text"
                    placeholder="VD: NGUY·ªÑN VƒÇN A"
                    required
                  />
                </div>
                <p id="errName" class="help is-error" style="display: none">
                  Vui l√≤ng nh·∫≠p H·ªå V√Ä T√äN b·∫±ng ch·ªØ IN HOA (A-Z, kho·∫£ng tr·∫Øng,
                  t·ªëi thi·ªÉu 2 t·ª´).
                </p>
              </div>

              <div class="columns">
                <div class="column is-6">
                  <div class="field">
                    <label class="label is-required">NƒÉm sinh</label>
                    <div class="control">
                      <input
                        id="birthYear"
                        class="input"
                        type="text"
                        inputmode="numeric"
                        pattern="[0-9]*"
                        placeholder="VD: 2012"
                        required
                      />
                    </div>
                    <p id="errYear" class="help is-error" style="display: none">
                      Vui l√≤ng nh·∫≠p nƒÉm sinh (4 ch·ªØ s·ªë).
                    </p>
                  </div>
                </div>

                <div class="column is-6">
                  <div class="field">
                    <label class="label is-required">Tr∆∞·ªùng h·ªçc hi·ªán t·∫°i</label>
                    <div class="control">
                      <div class="select is-fullwidth">
                        <select id="school" required>
                          <option value="">-- Ch·ªçn tr∆∞·ªùng --</option>
                        </select>
                      </div>
                    </div>
                    <p
                      id="errSchool"
                      class="help is-error"
                      style="display: none"
                    >
                      Vui l√≤ng ch·ªçn tr∆∞·ªùng.
                    </p>
                  </div>
                </div>
              </div>

              <div class="columns">
                <div class="column is-6">
                  <div class="field">
                    <label class="label is-required">X√£/Ph∆∞·ªùng</label>
                    <div class="control">
                      <div class="select is-fullwidth">
                        <select id="ward" required>
                          <option value="">-- Ch·ªçn x√£/ph∆∞·ªùng --</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="column is-6">
                  <div class="field">
                    <label class="label is-required">T·ªï d√¢n ph·ªë / Th√¥n</label>
                    <div class="control">
                      <div class="select is-fullwidth">
                        <select id="hamlet" required>
                          <option value="">-- Ch·ªçn t·ªï d√¢n ph·ªë / th√¥n --</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <p id="errAddress" class="help is-error" style="display: none">
                Vui l√≤ng ch·ªçn ƒë·ªß x√£/ph∆∞·ªùng v√† t·ªï d√¢n ph·ªë.
              </p>

              <div class="field">
                <label class="label is-required">H·ªç v√† t√™n ph·ª• huynh</label>
                <div class="control">
                  <input
                    id="parentName"
                    class="input"
                    type="text"
                    placeholder="VD: Nguy·ªÖn Th·ªã B"
                    required
                  />
                </div>
                <p
                  id="errParentName"
                  class="help is-error"
                  style="display: none"
                >
                  Vui l√≤ng nh·∫≠p h·ªç t√™n ph·ª• huynh (√≠t nh·∫•t 2 t·ª´).
                </p>
              </div>

              <div class="field">
                <label class="label is-required">S·ªë ƒëi·ªán tho·∫°i ph·ª• huynh</label>
                <div class="control">
                  <input
                    id="parentPhone"
                    class="input"
                    type="text"
                    inputmode="numeric"
                    pattern="[0-9]*"
                    placeholder="VD: 0912345678"
                    required
                  />
                </div>
                <p id="errPhone" class="help is-error" style="display: none">
                  Ch·ªâ ƒë∆∞·ª£c nh·∫≠p s·ªë, 9-11 ch·ªØ s·ªë.
                </p>
              </div>

              <div class="field is-grouped" style="margin-top: 2rem">
                <div class="control">
                  <button id="btnSubmit" class="button is-primary is-medium">
                    L∆∞u ƒëƒÉng k√Ω
                  </button>
                </div>
                <div class="control">
                  <button
                    id="btnReset"
                    type="button"
                    class="button is-light is-medium"
                  >
                    Nh·∫≠p l·∫°i
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Floating Action Buttons -->
        <div style="position: fixed; bottom: 30px; right: 30px; z-index: 1000; display: flex; flex-direction: column; gap: 12px; align-items: flex-end">
          <!-- Home Button -->
          <a href="/Sinhhoathe/dangky.html" 
             style="display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #00d1b2 0%, #00a896 100%); color: white; padding: 12px 20px; border-radius: 50px; box-shadow: 0 4px 15px rgba(0, 209, 178, 0.4); text-decoration: none; font-weight: 600; transition: all 0.3s ease; font-size: 0.95rem"
             onmouseover="this.style.transform='translateX(-5px)'; this.style.boxShadow='0 6px 20px rgba(0, 209, 178, 0.5)'"
             onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 4px 15px rgba(0, 209, 178, 0.4)'">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="white">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            <span>Trang ch·ªß</span>
          </a>

          <!-- Contact Facebook Button -->
          <a href="https://www.facebook.com/doanphuonglaocai/" target="_blank" rel="noopener noreferrer" 
             style="display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #1877F2 0%, #0d5dbf 100%); color: white; padding: 12px 20px; border-radius: 50px; box-shadow: 0 4px 15px rgba(24, 119, 242, 0.4); text-decoration: none; font-weight: 600; transition: all 0.3s ease; font-size: 0.95rem"
             onmouseover="this.style.transform='translateX(-5px)'; this.style.boxShadow='0 6px 20px rgba(24, 119, 242, 0.5)'"
             onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 4px 15px rgba(24, 119, 242, 0.4)'">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="white">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
            <span>Li√™n h·ªá</span>
          </a>

          <!-- Info/Promo Button -->
          <a href="/Sinhhoathe/thongtinkhoa.html" target="_blank" rel="noopener noreferrer"
             style="display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); color: white; padding: 12px 20px; border-radius: 50px; box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4); text-decoration: none; font-weight: 600; transition: all 0.3s ease; font-size: 0.95rem"
             onmouseover="this.style.transform='translateX(-5px)'; this.style.boxShadow='0 6px 20px rgba(255, 107, 107, 0.5)'"
             onmouseout="this.style.transform='translateX(0)'; this.style.boxShadow='0 4px 15px rgba(255, 107, 107, 0.4)'">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="white">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
            </svg>
            <span>Th√¥ng tin c√°c kh√≥a tr·∫£i nghi·ªám ng·∫Øn h·∫°n</span>
          </a>
        </div>

        <div class="notification is-info is-light" style="margin-top: 1.5rem">
          <strong>üìå Quy tr√¨nh:</strong>
          <ol style="margin-top: 0.5rem; margin-left: 1.5rem">
            <li>B∆∞·ªõc 1: ƒêi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b√™n tr√™n.</li>
            <li>B∆∞·ªõc 2: Nh·∫•n "L∆∞u ƒëƒÉng k√Ω".</li>
            <li>
              B∆∞·ªõc 3: Khu d√¢n c∆∞ x√°c nh·∫≠n, x·∫øp lo·∫°i khi k·∫øt th√∫c sinh ho·∫°t h√® ->
              G·ª≠i k·∫øt qu·∫£ v·ªÅ ƒêo√†n ph∆∞·ªùng.
            </li>
            <li>
              B∆∞·ªõc 4: ƒêo√†n ph∆∞·ªùng x√°c nh·∫≠n th√¥ng tin do Khu d√¢n c∆∞ cung c·∫•p, g·ª≠i
              k·∫øt qu·∫£ v·ªÅ c√°c tr∆∞·ªùng h·ªçc.
            </li>
            <br />
            <strong>L∆∞u √Ω:</strong>
            Phi·∫øu Online n√†y thay th·∫ø cho phi·∫øu gi·∫•y th√¥ng th∆∞·ªùng c·ªßa nh·ªØng nƒÉm
            tr∆∞·ªõc. Ph·ª• huynh kh√¥ng c·∫ßn xin x√°c nh·∫≠n hay n·ªôp b·∫•t c·ª© gi·∫•y t·ªù g√¨
            kh√°c.
          </ol>
        </div>

        <!-- Danh s√°ch ƒë√£ ƒëƒÉng k√Ω -->
        <div class="card saved-list" style="margin-top: 2rem">
          <div class="card-content">
            <div class="level">
              <div class="level-left">
                <h2 class="title is-5">
                  Danh s√°ch ƒë√£ ƒëƒÉng k√Ω
                  <span id="totalBadge" class="tag is-info is-light">0</span>
                </h2>
              </div>
              <div class="level-right">
                <div class="field">
                  <div class="control">
                    <input
                      id="searchInput"
                      class="input"
                      type="text"
                      style="width: 350px; max-width: 100%"
                      placeholder="T√¨m theo t√™n h·ªçc sinh ho·∫∑c ph·ª• huynh..."
                    />
                  </div>
                </div>
              </div>
            </div>

            <div class="notification is-info is-light">
              <strong>üí° M·∫πo:</strong> S·ª≠ d·ª•ng √¥ t√¨m ki·∫øm ƒë·ªÉ ki·ªÉm tra xem b·∫°n ƒë√£
              ƒëƒÉng k√Ω ch∆∞a.
            </div>

            <div class="table-container">
              <table class="table is-fullwidth is-striped is-hoverable">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>H·ªç v√† t√™n</th>
                    <th>NƒÉm sinh</th>
                    <th>Tr∆∞·ªùng</th>
                    <th>ƒê·ªãa ch·ªâ</th>
                    <th>Ph·ª• huynh</th>
                    <th>SƒêT PH</th>
                  </tr>
                </thead>
                <tbody id="registrationsList"></tbody>
              </table>
            </div>

            <!-- Pagination -->
            <nav
              id="pagination"
              class="pagination is-centered is-small"
              role="navigation"
              aria-label="pagination"
              style="margin-top: 1.5rem; min-height: 40px"
            >
              <!-- JS s·∫Ω ƒëi·ªÅn n·ªôi dung v√†o ƒë√¢y -->
            </nav>
          </div>
        </div>
      </div>
    </section>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="/Sinhhoathe/firebase.config.js"></script>

    <script>
      // DOM elements
      const el = {
        fullName: document.getElementById("fullName"),
        birthYear: document.getElementById("birthYear"),
        school: document.getElementById("school"),
        ward: document.getElementById("ward"),
        hamlet: document.getElementById("hamlet"),
        parentName: document.getElementById("parentName"),
        parentPhone: document.getElementById("parentPhone"),
        btnSubmit: document.getElementById("btnSubmit"),
        btnReset: document.getElementById("btnReset"),
        errName: document.getElementById("errName"),
        errYear: document.getElementById("errYear"),
        errSchool: document.getElementById("errSchool"),
        errAddress: document.getElementById("errAddress"),
        errParentName: document.getElementById("errParentName"),
        errPhone: document.getElementById("errPhone"),
      };

      const searchInput = document.getElementById("searchInput");
      const registrationsList = document.getElementById("registrationsList");
      const totalBadge = document.getElementById("totalBadge");
      const paginationContainer = document.getElementById("pagination");

      let ALL_REGISTRATIONS = [];
      let searchQuery = "";
      let currentPage = 1;
      const itemsPerPage = 5;

      let META_CACHE = { schools: [], wards: [], hamlets: {} };

      // Load metadata from Firebase
      function loadMetadata() {
        if (
          !window.firebase ||
          !window.firebase.apps ||
          !window.firebase.apps.length
        ) {
          console.error("Firebase not initialized");
          return;
        }

        const metaRef = firebase.database().ref("meta");
        metaRef.on("value", (snap) => {
          const data = snap.val() || {};
          META_CACHE = {
            schools: data.schools || [],
            wards: data.wards || [],
            hamlets: data.hamlets || {},
          };
          renderMetaOptions();
        });
      }

      function renderMetaOptions() {
        // Populate schools
        el.school.innerHTML = '<option value="">-- Ch·ªçn tr∆∞·ªùng --</option>';
        META_CACHE.schools.forEach((s) => {
          const opt = document.createElement("option");
          opt.value = s;
          opt.textContent = s;
          el.school.appendChild(opt);
        });

        // Populate wards
        el.ward.innerHTML = '<option value="">-- Ch·ªçn x√£/ph∆∞·ªùng --</option>';
        META_CACHE.wards.forEach((w) => {
          const opt = document.createElement("option");
          opt.value = w;
          opt.textContent = w;
          el.ward.appendChild(opt);
        });

        // Reset hamlet
        el.hamlet.innerHTML =
          '<option value="">-- Ch·ªçn t·ªï d√¢n ph·ªë / th√¥n --</option>';
      }

      // Ward change handler
      el.ward.addEventListener("change", () => {
        const selectedWard = el.ward.value;
        el.hamlet.innerHTML =
          '<option value="">-- Ch·ªçn t·ªï d√¢n ph·ªë / th√¥n --</option>';

        if (selectedWard && META_CACHE.hamlets[selectedWard]) {
          META_CACHE.hamlets[selectedWard].forEach((h) => {
            const opt = document.createElement("option");
            opt.value = h;
            opt.textContent = h;
            el.hamlet.appendChild(opt);
          });
        }
      });

      // Mask phone number
      function maskPhone(phone) {
        if (!phone || phone.length < 3) return "***";
        const last3 = phone.slice(-3);
        return "***" + last3;
      }

      // Normalize string for search
      function normalizeString(str) {
        if (!str) return "";
        return str
          .toLowerCase()
          .normalize("NFD")
          .replace(/[\u0300-\u036f]/g, "");
      }

      // Render Pagination
      function renderPagination(totalItems) {
        paginationContainer.innerHTML = "";
        const totalPages = Math.ceil(totalItems / itemsPerPage);

        if (totalPages <= 1) return;

        // Previous Button
        const prevBtn = document.createElement("a");
        prevBtn.className = "pagination-previous";
        prevBtn.textContent = "Tr∆∞·ªõc";
        if (currentPage === 1) prevBtn.setAttribute("disabled", true);
        else
          prevBtn.onclick = () => {
            currentPage--;
            renderRegistrationsList();
          };
        paginationContainer.appendChild(prevBtn);

        // Next Button
        const nextBtn = document.createElement("a");
        nextBtn.className = "pagination-next";
        nextBtn.textContent = "Sau";
        if (currentPage === totalPages) nextBtn.setAttribute("disabled", true);
        else
          nextBtn.onclick = () => {
            currentPage++;
            renderRegistrationsList();
          };
        paginationContainer.appendChild(nextBtn);

        // List
        const ul = document.createElement("ul");
        ul.className = "pagination-list";

        for (let i = 1; i <= totalPages; i++) {
          const li = document.createElement("li");
          const a = document.createElement("a");
          a.className = `pagination-link ${
            i === currentPage ? "is-current" : ""
          }`;
          a.textContent = i;
          a.onclick = () => {
            currentPage = i;
            renderRegistrationsList();
          };
          li.appendChild(a);
          ul.appendChild(li);
        }
        paginationContainer.appendChild(ul);
      }

      // Render registrations list
      function renderRegistrationsList() {
        if (!registrationsList) return;
        registrationsList.innerHTML = "";

        const normalizedQuery = normalizeString(searchQuery);
        const filtered = ALL_REGISTRATIONS.filter((item) => {
          if (!normalizedQuery) return true;
          const fullName = normalizeString(item.fullName || "");
          const parentName = normalizeString(item.parentName || "");
          return (
            fullName.includes(normalizedQuery) ||
            parentName.includes(normalizedQuery)
          );
        });

        const totalItems = filtered.length;

        // C·∫≠p nh·∫≠t Badge
        if (totalBadge) {
          if (normalizedQuery) {
            totalBadge.textContent = `${totalItems}/${ALL_REGISTRATIONS.length}`;
            totalBadge.className = "tag is-success is-light";
          } else {
            totalBadge.textContent = ALL_REGISTRATIONS.length;
            totalBadge.className = "tag is-info is-light";
          }
        }

        if (totalItems === 0) {
          const tr = document.createElement("tr");
          const td = document.createElement("td");
          td.colSpan = 7;
          td.className = "has-text-centered has-text-grey";
          td.textContent = normalizedQuery
            ? "Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o."
            : "Ch∆∞a c√≥ ƒëƒÉng k√Ω n√†o.";
          tr.appendChild(td);
          registrationsList.appendChild(tr);
          paginationContainer.innerHTML = ""; // X√≥a pagination khi kh√¥ng c√≥ d·ªØ li·ªáu
          return;
        }

        // Logic c·∫Øt trang
        const start = (currentPage - 1) * itemsPerPage;
        const end = start + itemsPerPage;
        const pageItems = filtered.slice(start, end);

        pageItems.forEach((item, idx) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${start + idx + 1}</td>
            <td>${item.fullName || ""}</td>
            <td>${item.birthYear || ""}</td>
            <td>${item.school || ""}</td>
            <td>
              <strong>${item.hamlet || ""}</strong><br>
              <span class="is-size-7 has-text-grey">${item.ward || ""}</span>
            </td>
            <td>${item.parentName || ""}</td>
            <td>${maskPhone(item.parentPhone || "")}</td>
          `;
          registrationsList.appendChild(tr);
        });

        renderPagination(totalItems);
      }

      // Subscribe to all registrations
      function subscribeAllRegistrations() {
        if (
          !window.firebase ||
          !window.firebase.apps ||
          !window.firebase.apps.length
        ) {
          return;
        }

        const ref = firebase.database().ref("registrations");
        ref.on("value", (snap) => {
          ALL_REGISTRATIONS = [];
          const data = snap.val();
          if (data) {
            Object.keys(data).forEach((key) => {
              ALL_REGISTRATIONS.push({ ...data[key], _key: key });
            });
          }
          renderRegistrationsList();
        });
      }

      // Search handler
      if (searchInput) {
        searchInput.addEventListener("input", (e) => {
          searchQuery = e.target.value.trim();
          currentPage = 1; // Reset v·ªÅ trang 1 khi t√¨m ki·∫øm
          renderRegistrationsList();
        });
      }

      // Local fallback
      function saveToLocal(payload) {
        const arr = JSON.parse(localStorage.getItem("summer-regs") || "[]");
        arr.push(payload);
        localStorage.setItem("summer-regs", JSON.stringify(arr));
      }

      // Firebase helpers
      function saveToFirebase(payload) {
        if (
          window.firebase &&
          window.firebase.apps &&
          window.firebase.apps.length
        ) {
          return firebase.database().ref("registrations").push(payload);
        }
        return Promise.reject(new Error("firebase_not_available"));
      }

      // Form validation & submission
      el.btnSubmit.addEventListener("click", (e) => {
        e.preventDefault();

        // Reset errors
        [
          el.errName,
          el.errYear,
          el.errSchool,
          el.errAddress,
          el.errParentName,
          el.errPhone,
        ].forEach((err) => (err.style.display = "none"));

        let hasError = false;

        // Validate name
        const nameVal = el.fullName.value.trim();
        if (
          !/^([A-Z√Ä-·ª∏\s]+)$/.test(nameVal) ||
          nameVal.split(/\s+/).length < 2
        ) {
          el.errName.style.display = "";
          hasError = true;
        }

        // Validate year
        const year = parseInt(el.birthYear.value, 10);
        if (!/^[0-9]{4}$/.test(el.birthYear.value)) {
          el.errYear.style.display = "";
          hasError = true;
        }

        // Validate school
        if (!el.school.value) {
          el.errSchool.style.display = "";
          hasError = true;
        }

        // Validate address
        if (!el.ward.value || !el.hamlet.value) {
          el.errAddress.style.display = "";
          hasError = true;
        }

        // Validate parent name
        const pnVal = el.parentName.value.trim();
        if (pnVal.split(/\s+/).length < 2) {
          el.errParentName.style.display = "";
          hasError = true;
        }

        // Validate phone
        if (!/^\d{9,11}$/.test(el.parentPhone.value)) {
          el.errPhone.style.display = "";
          hasError = true;
        }

        if (hasError) return;

        const payload = {
          fullName: nameVal,
          birthYear: el.birthYear.value,
          school: el.school.value,
          ward: el.ward.value,
          hamlet: el.hamlet.value,
          parentName: pnVal,
          parentPhone: el.parentPhone.value,
          grade: "",
          savedAt: Date.now(),
        };

        saveToFirebase(payload)
          .then(() => {
            el.birthYear.value = "";
            el.school.value = "";
            el.ward.value = "";
            el.parentName.value = "";
            el.parentPhone.value = "";
            el.fullName.value = "";
            el.hamlet.innerHTML =
              '<option value="">-- Ch·ªçn t·ªï d√¢n ph·ªë / th√¥n --</option>';
            alert("ƒê√£ l∆∞u th√¥ng tin ƒëƒÉng k√Ω.");
          })
          .catch(() => {
            try {
              saveToLocal(payload);
            } catch (err) {
              console.error(err);
            }
            el.birthYear.value = "";
            el.school.value = "";
            el.ward.value = "";
            el.parentName.value = "";
            el.parentPhone.value = "";
            el.fullName.value = "";
            el.hamlet.innerHTML =
              '<option value="">-- Ch·ªçn t·ªï d√¢n ph·ªë / th√¥n --</option>';
            alert("ƒê√£ l∆∞u th√¥ng tin ƒëƒÉng k√Ω.");
          });
      });

      // Reset button
      el.btnReset.addEventListener("click", () => {
        el.fullName.value = "";
        el.birthYear.value = "";
        el.school.value = "";
        el.ward.value = "";
        el.hamlet.innerHTML =
          '<option value="">-- Ch·ªçn t·ªï d√¢n ph·ªë / th√¥n --</option>';
        el.parentName.value = "";
        el.parentPhone.value = "";
        [
          el.errName,
          el.errYear,
          el.errSchool,
          el.errAddress,
          el.errParentName,
          el.errPhone,
        ].forEach((err) => (err.style.display = "none"));
      });

      // Initialize
      loadMetadata();
      subscribeAllRegistrations();
    </script>
  </body>
</html>
